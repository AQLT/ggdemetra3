<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggplot2 Extension for Seasonal and Trading Day Adjustment with RJDemetra3 • ggdemetra3</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="ggplot2 Extension for Seasonal and Trading Day Adjustment with RJDemetra3">
<meta property="og:description" content="Provides ggplot2 functions to return the results of seasonal and trading day adjustment 
    made by RJDemetra3.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggdemetra3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/ggdemetra3.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/jdemetra/rjdemetra" class="external-link">RJDemetra</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    JDemetra+
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/jdemetra/jdemetra-app/releases" class="external-link">Download JDemetra+</a>
    </li>
    <li>
      <a href="https://jdemetradocumentation.github.io/JDemetra-documentation/" class="external-link">JDemetra+ documentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/AQLT/ggdemetra3" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ggdemetra-">ggdemetra <img src="reference/figures/logo.png" align="right" alt=""><a class="anchor" aria-label="anchor" href="#ggdemetra-"></a>
</h1></div>

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>ggdemetra is an extension of <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a> to add seasonal adjustment statistics to your plots. The seasonal adjustment process is done with <a href="https://github.com/jdemetra/rjdemetra" class="external-link">RJDemetra</a> that is an R interface to <a href="https://github.com/jdemetra/jdemetra-app" class="external-link">JDemetra+</a>, the seasonal adjustment software <a href="https://ec.europa.eu/eurostat/cros/system/files/Jdemetra_%20release.pdf" class="external-link">officially recommended</a> to the members of the European Statistical System (ESS) and the European System of Central Banks. RJDemetra implements the two leading seasonal adjustment methods <a href="http://gretl.sourceforge.net/tramo/tramo-seats.html" class="external-link">TRAMO/SEATS+</a> and <a href="https://www.census.gov/data/software/x13as.html" class="external-link">X-12ARIMA/X-13ARIMA-SEATS</a>.</p>
<p>There are 4 main functionnalities in <code>ggdemetra</code> depending of what you want to add in the graphic:</p>
<ul>
<li>
<code><a href="reference/geom_sa.html">geom_sa()</a></code>: to add a time series compute during the seasonal adjustment (the trend, the seasonal adjusted time series, etc.).<br>
</li>
<li>
<code><a href="reference/geom_outlier.html">geom_outlier()</a></code>: to add the outliers used in the pre-adjustment process of the seasonal adjustment.</li>
<li>
<code><a href="reference/geom_arima.html">geom_arima()</a></code>: to add the ARIMA model used in the pre-adjustment process of the seasonal adjustment.</li>
<li>
<code><a href="reference/geom_diagnostics.html">geom_diagnostics()</a></code>: to add a table containing some diagnostics on the seasonal adjustment process.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Since RJDemetra requires Java SE 8 or later version, the same requirements are also needed for ggdemetra.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install release version from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggdemetra"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install development version from GitHub</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AQLT/ggdemetra"</span><span class="op">)</span></span></code></pre></div>
<p>If you have troubles with the installation of RJDemetra, check the <a href="https://github.com/jdemetra/rjdemetra/wiki/Installation-manual" class="external-link">installation manual</a>.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>By default, the seasonal adjustment is made with X-13-ARIMA with the pre-defined specification “RSA5c” (automatic log detection, automatic ARIMA and outliers detection and trading day and easter adjustment). If no new data or seasonal adjustment specification is specified (method or specification), these parameters is inherited from the previous defined: therefore you only need to specify the specification once. In the following examples, the seasonal adjustment will be perform with X-13-ARIMA with working day adjustment and no gradual easter effect adjustment (it is the specification that has the most economic sense for the industrial production index).</p>
<p>To add the seasonal adjusted series and the forecasts of the input data and of the seasonal adjusted series:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AQLT/ggdemetra" class="external-link">ggdemetra</a></span><span class="op">)</span></span>
<span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu">RJDemetra</span><span class="fu">::</span><span class="fu">x13_spec</span><span class="op">(</span><span class="st">"RSA3"</span>, tradingdays.option <span class="op">=</span> <span class="st">"WorkingDays"</span><span class="op">)</span></span>
<span><span class="va">p_ipi_fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ipi_c_eu_df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">FR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Seasonal adjustment of the French industrial production index"</span>,</span>
<span>         x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">p_sa</span> <span class="op">&lt;-</span> <span class="va">p_ipi_fr</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"y_f"</span>, linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            spec <span class="op">=</span> <span class="va">spec</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"sa"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"sa_f"</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_sa</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>To add the outliers at the bottom of the plot with an arrow to the data point and the estimated coefficients:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="reference/geom_outlier.html">geom_outlier</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label_repel"</span>,</span>
<span>                 coefficients <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 vjust <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">65</span><span class="op">)</span>, force <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                               type <span class="op">=</span> <span class="st">"closed"</span>, ends <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span>,</span>
<span>                 digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>To add the ARIMA model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="reference/geom_arima.html">geom_arima</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>               x_arima <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y_arima <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, </span>
<span>               vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>To add a table of diagnostics below the plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Combined test` <span class="op">=</span> <span class="st">"diagnostics.combined.all.summary"</span>,</span>
<span>                 `Residual qs-test (p-value)` <span class="op">=</span> <span class="st">"diagnostics.qs"</span>,</span>
<span>                 `Residual f-test (p-value)` <span class="op">=</span> <span class="st">"diagnostics.ftest"</span><span class="op">)</span></span>
<span><span class="va">p_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ipi_c_eu_df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">FR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="reference/geom_diagnostics.html">geom_diagnostics</a></span><span class="op">(</span>diagnostics <span class="op">=</span> <span class="va">diagnostics</span>,</span>
<span>                     table_theme <span class="op">=</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">ttheme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                     message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p_sa</span>, <span class="va">p_diag</span>,</span>
<span>             nrow <span class="op">=</span> <span class="fl">2</span>, heights  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>See the <a href="https://aqlt.github.io/ggdemetra/articles/ggdemetra.html" class="external-link">vignette</a> for more details.</p>
<p>Note that <code>ts</code> objects cannot be directly used in <code>ggplot2</code>. To convert <code>ts</code> or <code>mts</code> object to <code>data.frame</code>, you can use the <code><a href="reference/ts2df.html">ts2df()</a></code> function. For example, the data <code>ipi_c_eu_df</code> used in this package is obtained by applying the <code><a href="reference/ts2df.html">ts2df()</a></code>function to the <code>ipi_c_eu</code> data available in RJDemetra:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipi_c_eu_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ts2df.html">ts2df</a></span><span class="op">(</span><span class="va">ipi_c_eu</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AQLT/ggdemetra3/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/AQLT/ggdemetra3/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>EUPL</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggdemetra3</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alain Quartier-la-Tente <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7890-3857" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AQLT/ggdemetra/actions" class="external-link"><img src="https://github.com/AQLT/ggdemetra/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=ggdemetra" class="external-link"><img src="http://www.r-pkg.org/badges/version/ggdemetra" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=ggdemetra" class="external-link"><img src="http://www.r-pkg.org/badges/last-release/ggdemetra" alt="CRAN last release"></a></li>
<li><a href="https://cran.r-project.org/package=ggdemetra" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/ggdemetra?color=lightgrey" alt="CRAN monthly downloads"></a></li>
<li><a href="https://cran.r-project.org/package=ggdemetra" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/ggdemetra?color=lightgrey" alt="CRAN downloads"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Alain Quartier-la-Tente.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
