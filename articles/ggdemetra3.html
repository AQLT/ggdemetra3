<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggdemetra3: extending ggplot2 to perform seasonal adjustment with rjdemetra3 â€¢ ggdemetra3</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ggdemetra3: extending ggplot2 to perform seasonal adjustment with rjdemetra3">
<meta property="og:description" content="ggdemetra3">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggdemetra3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggdemetra3.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/jdemetra/rjdemetra" class="external-link">RJDemetra</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    JDemetra+
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/jdemetra/jdemetra-app/releases" class="external-link">Download JDemetra+</a>
    </li>
    <li>
      <a href="https://jdemetradocumentation.github.io/JDemetra-documentation/" class="external-link">JDemetra+ documentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/AQLT/ggdemetra3" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ggdemetra3_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ggdemetra3: extending ggplot2 to perform seasonal adjustment with rjdemetra3</h1>
                        <h4 data-toc-skip class="author">Alain Quartier-la-Tente</h4>
            
            <h4 data-toc-skip class="date">2023-09-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AQLT/ggdemetra3/blob/HEAD/vignettes/ggdemetra3.Rmd" class="external-link"><code>vignettes/ggdemetra3.Rmd</code></a></small>
      <div class="hidden name"><code>ggdemetra3.Rmd</code></div>

    </div>

    
    
<p><code>ggdemetra3</code> is an extension of <code>ggplot2</code> to add seasonal adjustment statistics to your plots. The seasonal adjustment process is done with <a href="https://github.com/rjdemetra/rjdemetra3" class="external-link">rjdemetra3</a> that is an R interface to <a href="https://github.com/jdemetra/jdemetra-app" class="external-link">JDemetra+ 3.0</a>, the seasonal adjustment software officially recommended to the members of the European Statistical System (ESS) and the European System of Central Banks. <code>rjdemetra3</code> implements the two leading seasonal adjustment methods <a href="http://gretl.sourceforge.net/tramo/tramo-seats.html" class="external-link">TRAMO/SEATS+</a> and <a href="https://www.census.gov/data/software/x13as.html" class="external-link">X-12ARIMA/X-13ARIMA-SEATS</a>.</p>
<p>There are 4 main functionalities in <code>ggdemetra3</code> depending of what you want to add in the graphic:</p>
<ul>
<li>
<code><a href="../reference/geom_sa.html">geom_sa()</a></code>: to add a time series compute during the seasonal adjustment (the trend, the seasonal adjusted time series, etc.).<br>
</li>
<li>
<code>geom_outliers()</code>: to add the outliers used in the pre-adjustment process of the seasonal adjustment.</li>
<li>
<code><a href="../reference/geom_arima.html">geom_arima()</a></code>: to add the ARIMA model used in the pre-adjustment process of the seasonal adjustment.</li>
<li>
<code><a href="../reference/geom_diagnostics.html">geom_diagnostics()</a></code>: to add a table containing some diagnostics on the seasonal adjustment process.</li>
</ul>
<p>Note <code>ts</code> objects cannot be directly used in <code>ggplot2</code>. To convert <code>ts</code> or <code>mts</code> object to <code>data.frame</code>, you can use the <code><a href="../reference/ts2df.html">ts2df()</a></code> function. For example, the data <code>ipi_c_eu_df</code> used in this package is obtained by applying the <code><a href="../reference/ts2df.html">ts2df()</a></code>function to the <code>ipi_c_eu</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipi_c_eu_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts2df.html">ts2df</a></span><span class="op">(</span><span class="va">ipi_c_eu</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="seasonal-adjustment-specification">Seasonal adjustment specification<a class="anchor" aria-label="anchor" href="#seasonal-adjustment-specification"></a>
</h2>
<p>All the functions have some common parameters and especially those to defined the seasonal adjustment method:</p>
<ul>
<li>
<code>method</code> is the method used for the seasonal adjustment: X-13ARIMA (<code>method = "x13"</code>, the default) or TRAMO-SEATS (<code>method = "tramoseats"</code>).<br>
</li>
<li>
<code>spec</code> is the seasonal adjustment specification. It can be the name of pre-defined specification (see <code><a href="https://rdrr.io/pkg/rjd3x13/man/x13.html" class="external-link">?rjd3x13::x13</a></code> or <code><a href="https://rdrr.io/pkg/rjd3tramoseats/man/tramoseats.html" class="external-link">?rjd3tramoseats::tramoseats</a></code>) or a user-defined specification created.<br>
</li>
<li>
<code>frequency</code> is the frequency of the input time series. By default, the frequency is computed and a message is printed with the one chosen (use <code>message = FALSE</code> to suppress this message).</li>
</ul>
<p>In the following examples, the data used is the French industrial production index. By default, the seasonal adjustment will then be processed with X-13ARIMA with a pre-defined specification <code>"RSA5c</code> (automatic log detection, automatic ARIMA and outliers detection and trading day and easter adjustment). However, in the industrial production the working day effect has more economic sense than the trading day effect and a gradual effect for easter does not make economic sense for the aggregated series. The specification that should be used with X-13ARIMA is <code>spec = rjd3toolkit::set_tradingdays(rjd3x13::spec_x13("rsa3"), option = "workingdays")</code>. If no new data or seasonal adjustment specification is specified (method or specification), these parameters is inherited from the previous defined: therefore you only need to specify this parameter once.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AQLT/ggdemetra3" class="external-link">ggdemetra3</a></span><span class="op">)</span></span>
<span><span class="va">p_ipi_fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ipi_c_eu_df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">FR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Seasonal adjustment of the French industrial production index"</span>,</span>
<span>         x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">p_ipi_fr</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="add-the-result-of-the-seasonal-adjusment">Add the result of the seasonal adjusment<a class="anchor" aria-label="anchor" href="#add-the-result-of-the-seasonal-adjusment"></a>
</h2>
<p>By default <code><a href="../reference/geom_sa.html">geom_sa()</a></code> adds the seasonal adjusted time series:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu">rjd3x13</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rjd3x13/man/spec_x13.html" class="external-link">spec_x13</a></span><span class="op">(</span><span class="st">"rsa3"</span><span class="op">)</span></span>
<span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu">rjd3toolkit</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rjd3toolkit/man/set_tradingdays.html" class="external-link">set_tradingdays</a></span><span class="op">(</span><span class="va">spec</span>, option <span class="op">=</span> <span class="st">"WorkingDays"</span><span class="op">)</span></span>
<span><span class="va">p_ipi_fr</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>            spec <span class="op">=</span> <span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; Frequency used: 12</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>To add other components of the seasonal adjustment, use the <code>component</code> parameter of <code><a href="../reference/geom_sa.html">geom_sa()</a></code> (see <code>?rjd3x13::userdefined_variables_x13()</code> or <code>?rjd3tramoseats::userdefined_variables_tramoseats()</code> for the availables parameters). For example, to add the forecasts of the input data and of the seasonal adjusted series:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">&lt;-</span> <span class="va">p_ipi_fr</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"y_f(12)"</span>, linetype <span class="op">=</span> <span class="fl">2</span>, message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            spec <span class="op">=</span> <span class="va">spec</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"sa"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/geom_sa.html">geom_sa</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"sa_f"</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_sa</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="add-the-outliers-to-the-plot">Add the outliers to the plot<a class="anchor" aria-label="anchor" href="#add-the-outliers-to-the-plot"></a>
</h2>
<p>There are four differents geometrics to add to the plot the names of the outliers used in the pre-adjustment process:</p>
<ul>
<li>
<code>geom = "text"</code> (the default) adds directly the names of the outliers and <code>geom = "label"</code> draws a rectangle behind the names, making them easier to read.<br>
</li>
<li>
<code>geom = "text_repel"</code> and <code>geom = "label_repel"</code> do the same but text labels repel away from each other and away from the data points (see <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">?ggrepel::geom_label_repel</a></code>).</li>
</ul>
<p>In our example, there are 3 outliers:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_outlier.html">geom_outlier</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>They can be plotted in more readable way using the parameters of <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_label_repel</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_outlier.html">geom_outlier</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label_repel"</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">65</span><span class="op">)</span>, force <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                               type <span class="op">=</span> <span class="st">"closed"</span>, ends <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>Use the parameters <code>first_date</code> and <code>last_date</code> to only have the outliers in a precise time interval. For example, to only plot the outliers from 2009 use <code>first_date = 2009</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_outlier.html">geom_outlier</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label_repel"</span>,</span>
<span>                 first_date <span class="op">=</span> <span class="fl">2009</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">65</span><span class="op">)</span>, force <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="st">"npc"</span><span class="op">)</span>,</span>
<span>                               type <span class="op">=</span> <span class="st">"closed"</span>, ends <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="add-the-arima-model">Add the ARIMA model<a class="anchor" aria-label="anchor" href="#add-the-arima-model"></a>
</h2>
<p>The ARIMA model used pre-adjustment process can be added to the plot with <code>geom_ arima()</code>. The parameter <code>geom = "label"</code> draws a rectangle behind the ARIMA model, making it easier to read:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_arima.html">geom_arima</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>               x_arima <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y_arima <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, </span>
<span>               vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="add-a-table-with-some-diagnostics">Add a table with some diagnostics<a class="anchor" aria-label="anchor" href="#add-a-table-with-some-diagnostics"></a>
</h2>
<p>A table with some diagnostics on the seasonal adjustment process can be added with <code><a href="../reference/geom_diagnostics.html">geom_diagnostics()</a></code>. The desired diagnostics have to be added to the <code>diagnostics</code> parameter (see <code>?rjd3x13::userdefined_variables_x13()</code> or <code>?rjd3tramoseats::userdefined_variables_tramoseats()</code> for the availables diagnostics). For example, to add the result of the X-11 Q-m2 statistic and the p-values of the residual seasonality qs and f tests:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m-statistics.q-m2"</span>,</span>
<span>                 <span class="st">"diagnostics.seas-sa-qs"</span>,</span>
<span>                 <span class="st">"diagnostics.seas-sa-f"</span><span class="op">)</span></span>
<span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_diagnostics.html">geom_diagnostics</a></span><span class="op">(</span>diagnostics <span class="op">=</span> <span class="va">diagnostics</span>,</span>
<span>                     ymin <span class="op">=</span> <span class="fl">58</span>, ymax <span class="op">=</span> <span class="fl">72</span>, xmin <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                     table_theme <span class="op">=</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">ttheme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
<p>To customize the names of the diagnostics in the plot, pass a named vector to the <code>diagnostics</code> parameter:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Q-M2` <span class="op">=</span> <span class="st">"m-statistics.q-m2"</span>,</span>
<span>                 `Residual qs-test (p-value)` <span class="op">=</span> <span class="st">"diagnostics.seas-sa-qs"</span>,</span>
<span>                 `Residual f-test (p-value)` <span class="op">=</span> <span class="st">"diagnostics.seas-sa-f"</span><span class="op">)</span></span>
<span><span class="va">p_sa</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/geom_diagnostics.html">geom_diagnostics</a></span><span class="op">(</span>diagnostics <span class="op">=</span> <span class="va">diagnostics</span>,</span>
<span>                     ymin <span class="op">=</span> <span class="fl">58</span>, ymax <span class="op">=</span> <span class="fl">72</span>, xmin <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                     table_theme <span class="op">=</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">ttheme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p>To add the table below the plot, you can for example use <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">gridExtra::grid.arrange()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ipi_c_eu_df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">FR</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/geom_diagnostics.html">geom_diagnostics</a></span><span class="op">(</span>diagnostics <span class="op">=</span> <span class="va">diagnostics</span>,</span>
<span>                     spec <span class="op">=</span> <span class="va">spec</span>,</span>
<span>                     table_theme <span class="op">=</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">ttheme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                     message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p_sa</span>, <span class="va">p_diag</span>,</span>
<span>             nrow <span class="op">=</span> <span class="fl">2</span>, heights  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="plot-models">Plot models<a class="anchor" aria-label="anchor" href="#plot-models"></a>
</h2>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> functions allows to plot an already estimated seasonal adjustment model. The <code>components</code> parameter allows to specify the printed components</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">rjd3x13</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rjd3x13/man/x13.html" class="external-link">x13</a></span><span class="op">(</span><span class="va">ipi_c_eu</span><span class="op">[</span>,<span class="st">"FR"</span><span class="op">]</span>,<span class="st">"rsa3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mod</span>, components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"sa"</span>, <span class="st">"trend"</span> <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/autoplot-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mod</span>, components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seasonal"</span> <span class="op">=</span> <span class="st">"s"</span>, <span class="st">"irregular"</span> <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdemetra3_files/figure-html/autoplot-2.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alain Quartier-la-Tente.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
